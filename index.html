<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ì–∞—Ä–∞–Ω—Ç ¬∑ WebApp</title>
  <meta name="description" content="–ö—Ä–∞—Å–∏–≤–∞—è WebApp-–ø–∞–Ω–µ–ª—å –≥–∞—Ä–∞–Ω—Ç–∞ –ø—Ä—è–º–æ –≤ Telegram.">
  <style>
    :root{
      --bg:#0d0f1a; --bg2:#12152a; --txt:#e8ecff; --muted:#a8b0d8;
      --border:rgba(255,255,255,0.14); --acc1:#8b5cf6; --acc2:#22d3ee;
      --good:#22c55e; --bad:#ef4444; --shadow:0 18px 40px rgba(0,0,0,0.45);
      --radius:22px;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial}
    body{background: radial-gradient(1100px 820px at 10% 0%, var(--bg2), var(--bg)); color:var(--txt);}
    .wrap{min-height:100%;display:grid;place-items:center;padding:16px}
    .app{width:min(980px,100%);background:linear-gradient(180deg,rgba(255,255,255,0.06),rgba(255,255,255,0.03));
      border:1px solid var(--border);border-radius:26px;box-shadow:var(--shadow);backdrop-filter:blur(14px);overflow:hidden}
    .top{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;border-bottom:1px solid var(--border);background:rgba(0,0,0,0.10)}
    .brand{display:flex;align-items:center;gap:10px;font-weight:800}
    .badge{font-size:12px;color:var(--muted);border:1px solid var(--border);padding:4px 8px;border-radius:999px}
    .grid{display:grid;grid-template-columns:280px 1fr;gap:14px;padding:14px}
    .panel{background:linear-gradient(180deg,rgba(255,255,255,0.07),rgba(255,255,255,0.04));border:1px solid var(--border);border-radius:var(--radius);padding:14px}
    .menu{display:grid;gap:10px}
    .menu .item{display:flex;align-items:center;gap:10px;padding:12px;border:1px solid var(--border);border-radius:14px;cursor:pointer;background:rgba(255,255,255,0.06);transition:transform .06s ease, background .2s ease}
    .menu .item:hover{background:rgba(255,255,255,0.09)} .menu .item:active{transform:translateY(1px) scale(.995)}
    .content{display:grid;gap:14px}
    .card{background:rgba(255,255,255,0.06);border:1px solid var(--border);border-radius:var(--radius);padding:16px}
    h2{margin:0 0 10px 0;font-size:20px}
    .muted{color:var(--muted);font-size:13px}
    .row{display:grid;gap:10px;grid-template-columns:repeat(2,1fr)}
    .input{display:flex;flex-direction:column;gap:6px}
    .input input,.input select,.input textarea{width:100%;padding:12px;border-radius:12px;border:1px solid var(--border);background:rgba(0,0,0,0.25);color:inherit;outline:none}
    .btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:12px 14px;border-radius:14px;border:1px solid var(--border);cursor:pointer;background:linear-gradient(180deg,var(--acc1),var(--acc2));color:#0a0f1f;font-weight:800;transition:transform .06s ease, filter .2s ease;text-decoration:none}
    .btn:hover{filter:brightness(1.06)} .btn:active{transform:translateY(1px) scale(.995)}
    .ghost{background:rgba(255,255,255,0.06);color:inherit;font-weight:600}
    .pill{border-radius:999px;padding:8px 12px;font-size:12px;border:1px solid var(--border);color:var(--muted)}
    .toolbar{display:flex;gap:10px;flex-wrap:wrap}
    @media(max-width:860px){.grid{grid-template-columns:1fr}.row{grid-template-columns:1fr}}
  </style>
</head>
<body>
<div class="wrap">
  <div class="app" id="app">
    <div class="top">
      <div class="brand">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M4 12a8 8 0 1 1 16 0 .8.8 0 1 1-1.6 0 6.4 6.4 0 1 0-6.4 6.4.8.8 0 1 1 0 1.6A8 8 0 0 1 4 12Z" fill="currentColor"/></svg>
        <span>–ì–∞—Ä–∞–Ω—Ç ¬∑ WebApp</span>
      </div>
      <span class="badge" id="who">–ì–æ—Å—Ç—å</span>
    </div>

    <div class="grid">
      <div class="panel">
        <div class="menu">
          <div class="item" data-tab="deal">üßæ –°–æ–∑–¥–∞—Ç—å —Å–¥–µ–ª–∫—É</div>
          <div class="item" data-tab="wallets">üí≥ –ö–æ—à–µ–ª—å–∫–∏</div>
          <div class="item" data-tab="ref">üß≤ –†–µ—Ñ–µ—Ä–∞–ª–∫–∞</div>
          <div class="item" data-tab="profile">üë§ –ü—Ä–æ—Ñ–∏–ª—å</div>
          <div class="item" data-tab="lang">üåê –Ø–∑—ã–∫</div>
          <div class="item" data-tab="help">üõü –ü–æ–¥–¥–µ—Ä–∂–∫–∞</div>
        </div>
      </div>

      <div class="content">
        <div class="card" id="tab-deal">
          <h2>üßæ –°–æ–∑–¥–∞—Ç—å —Å–¥–µ–ª–∫—É</h2>
          <div class="row">
            <div class="input">
              <label>–°—É–º–º–∞</label>
              <input id="amount" type="number" min="0" step="0.01" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä, 1500" />
            </div>
            <div class="input">
              <label>–ú–µ—Ç–æ–¥ –æ–ø–ª–∞—Ç—ã</label>
              <select id="method">
                <option value="ton">TON</option>
                <option value="sbp">RUB (–°–ë–ü/–∫–∞—Ä—Ç–∞)</option>
                <option value="stars">Telegram Stars</option>
              </select>
            </div>
          </div>
          <div class="input" style="margin-top:10px">
            <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
            <textarea id="descr" rows="3" placeholder="–ß—Ç–æ –ø—Ä–æ–¥–∞—ë—Ç–µ/–ø–æ–∫—É–ø–∞–µ—Ç–µ, —É—Å–ª–æ–≤–∏—è, –¥–µ–¥–ª–∞–π–Ω—ã..."></textarea>
          </div>
          <div class="toolbar" style="margin-top:12px">
            <button class="btn" id="create-deal">–°–æ–∑–¥–∞—Ç—å —Å–¥–µ–ª–∫—É</button>
            <span class="pill">–°–¥–µ–ª–∫–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è –æ—Ç –≤–∞—à–µ–≥–æ –∏–º–µ–Ω–∏. –°—Å—ã–ª–∫—É –Ω–∞ –æ–ø–ª–∞—Ç—É –±–æ—Ç –ø—Ä–∏—à–ª—ë—Ç –≤ —á–∞—Ç.</span>
          </div>
        </div>

        <div class="card" id="tab-wallets" style="display:none">
          <h2>üí≥ –ö–æ—à–µ–ª—å–∫–∏</h2>
          <div class="row">
            <div class="input"><label>TON-–∫–æ—à–µ–ª—ë–∫</label><input id="ton" type="text" placeholder="UQ... –∏–ª–∏ EQ..." /></div>
            <div class="input"><label>–ö–∞—Ä—Ç–∞/–°–ë–ü (RUB)</label><input id="card" type="text" placeholder="–ë–∞–Ω–∫ + –ø–æ—Å–ª–µ–¥–Ω–∏–µ 4 —Ü–∏—Ñ—Ä—ã –∏–ª–∏ ID –°–ë–ü" /></div>
          </div>
          <div class="toolbar" style="margin-top:12px">
            <button class="btn ghost" id="save-ton">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å TON</button>
            <button class="btn ghost" id="save-card">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞—Ä—Ç—É</button>
          </div>
        </div>

        <div class="card" id="tab-ref" style="display:none">
          <h2>üß≤ –†–µ—Ñ–µ—Ä–∞–ª–∫–∞</h2>
          <p class="muted">–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É ‚Äî –±–æ—Ç –ø—Ä–∏—à–ª—ë—Ç –µ—ë –≤ —á–∞—Ç.</p>
          <div class="toolbar" style="margin-top:12px"><button class="btn" id="get-ref">–ü–æ–ª—É—á–∏—Ç—å —Å—Å—ã–ª–∫—É</button></div>
        </div>

        <div class="card" id="tab-profile" style="display:none">
          <h2>üë§ –ü—Ä–æ—Ñ–∏–ª—å</h2>
          <p class="muted" id="profile-line">–í–∞—à –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–¥—Ç—è–Ω–µ—Ç—Å—è –∏–∑ Telegram.</p>
          <div class="toolbar" style="margin-top:12px"><button class="btn ghost" id="close-app">–ó–∞–∫—Ä—ã—Ç—å WebApp</button></div>
        </div>

        <div class="card" id="tab-lang" style="display:none">
          <h2>üåê –Ø–∑—ã–∫</h2>
          <div class="toolbar">
            <button class="btn ghost" data-lang="ru">–†—É—Å—Å–∫–∏–π</button>
            <button class="btn ghost" data-lang="en">English</button>
          </div>
          <p class="muted" style="margin-top:8px">–ë–æ—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç —Å–º–µ–Ω—É —è–∑—ã–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ–º –≤ —á–∞—Ç–µ.</p>
        </div>

        <div class="card" id="tab-help" style="display:none">
          <h2>üõü –ü–æ–¥–¥–µ—Ä–∂–∫–∞</h2>
          <p class="muted">–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å —á–∞—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –≤ Telegram.</p>
          <div class="toolbar" style="margin-top:12px">
            <a class="btn" id="support" href="#" target="_blank" rel="noreferrer">–û—Ç–∫—Ä—ã—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É</a>
          </div>
        </div>
      </div>
    </div>

    <div class="top" style="border-top:1px solid var(--border);border-bottom:none">
      <span class="muted">–í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ WebApp API. –ù–∏—á–µ–≥–æ –ª–∏—à–Ω–µ–≥–æ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ.</span>
    </div>
  </div>
</div>

<script>
(function(){
  const tg = window.Telegram?.WebApp;
  const t = (s)=>s; // –ø—Ä–æ—Å—Ç–∞—è –∑–∞–≥–ª—É—à–∫–∞ i18n (–≤—Å—è –ª–æ–∫–∞–ª—å —É –±–æ—Ç–∞)

  if(tg){
    tg.ready();
    tg.expand && tg.expand();
    const tp = tg.themeParams || {};
    if(tp.text_color){ document.body.style.color = tp.text_color; }
    const user = tg.initDataUnsafe?.user;
    if(user){
      document.getElementById("who").textContent = `@${user.username || user.first_name || "user"}`;
      document.getElementById("profile-line").textContent = `ID: ${user.id} ¬∑ ${user.first_name || ""} ${user.last_name || ""}`;
    }
  }

  const tabs = ["deal","wallets","ref","profile","lang","help"];
  const showTab = (name)=> tabs.forEach(t=>document.getElementById(`tab-${t}`).style.display = (t===name)?"":"none");
  document.querySelectorAll(".menu .item").forEach(el=> el.addEventListener("click", ()=> showTab(el.dataset.tab)));
  showTab("deal");

  const haptic = (type="impact")=>{
    try{
      if(!tg?.HapticFeedback) return;
      if(type==="impact") tg.HapticFeedback.impactOccurred("medium");
      if(type==="succ") tg.HapticFeedback.notificationOccurred("success");
      if(type==="err") tg.HapticFeedback.notificationOccurred("error");
    }catch(_){}
  };

  const send = (payload)=>{
    if(!tg){ alert("–û—Ç–∫—Ä–æ–π—Ç–µ —á–µ—Ä–µ–∑ Telegram"); return; }
    tg.sendData(JSON.stringify(payload));
    haptic("succ");
  };

  // Deal
  document.getElementById("create-deal").addEventListener("click", ()=>{
    const amount = parseFloat(document.getElementById("amount").value || "0");
    const description = (document.getElementById("descr").value || "").trim();
    const method = document.getElementById("method").value;
    if(!(amount>0)){ haptic("err"); alert("–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É > 0"); return; }
    if(description.length<3){ haptic("err"); alert("–û–ø–∏—à–∏—Ç–µ —Å–¥–µ–ª–∫—É –ø–æ–¥—Ä–æ–±–Ω–µ–µ"); return; }
    send({action:"create_deal", amount, description, payment_method: method});
  });

  // Wallets
  document.getElementById("save-ton").addEventListener("click", ()=>{
    const ton = (document.getElementById("ton").value || "").trim();
    if(ton.length<10){ haptic("err"); alert("–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π TON-–∞–¥—Ä–µ—Å"); return; }
    send({action:"set_wallet", kind:"ton", value: ton});
  });
  document.getElementById("save-card").addEventListener("click", ()=>{
    const card = (document.getElementById("card").value || "").trim();
    if(card.length<4){ haptic("err"); alert("–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã"); return; }
    send({action:"set_wallet", kind:"card", value: card});
  });

  // Referral
  document.getElementById("get-ref").addEventListener("click", ()=> send({action:"get_ref"}));

  // Language
  document.querySelectorAll("#tab-lang .btn[data-lang]").forEach(b=>{
    b.addEventListener("click", ()=> send({action:"set_lang", lang: b.dataset.lang}));
  });

  // Support
  const support = document.getElementById("support");
  support.addEventListener("click", (e)=>{
    // –°—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫—É –ø–æ–¥—Å—Ç–∞–≤–∏—Ç—Å—è —É –±–æ—Ç–∞ –≤ –æ—Ç–≤–µ—Ç–µ. –ó–¥–µ—Å—å ‚Äî –ø—Ä–æ—Å—Ç–æ –æ—Ç–∫—Ä—ã—Ç–∏–µ SUPPORT_URL, –µ—Å–ª–∏ –∑–∞–¥–∞–Ω –≤ initData
    // –ú–æ–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –≤ start_param, –Ω–æ –ø—Ä–æ—â–µ ‚Äî –±–æ—Ç –ø—Ä–∏—à–ª—ë—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ.
  });

  // Close
  document.getElementById("close-app").addEventListener("click", ()=> tg?.close && tg.close());
})();
</script>
</body>
</html>
